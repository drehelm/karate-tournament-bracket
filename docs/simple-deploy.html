<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simple Tournament Bracket</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      margin: 20px;
      padding: 0;
      max-width: 1000px;
      margin: 0 auto;
    }
    h1, h2 {
      color: #1a73e8;
    }
    .bracket-container {
      overflow-x: auto;
      margin: 20px 0;
      padding: 20px;
      border: 1px solid #ccc;
      border-radius: 8px;
      background: #f9f9f9;
    }
    .controls {
      margin-bottom: 20px;
      padding: 20px;
      background: #f5f5f5;
      border-radius: 8px;
    }
    button {
      background: #1a73e8;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
    }
    button:hover {
      background: #0d5bba;
    }
    .competitor-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 10px;
      margin: 10px 0 20px 0;
    }
    .competitor {
      display: flex;
      align-items: center;
    }
    .competitor input[type="number"] {
      width: 40px;
      margin-right: 10px;
    }
    .competitor input[type="text"] {
      flex: 1;
    }
  </style>
</head>
<body>
  <h1>Tournament Bracket Generator</h1>
  
  <div class="controls">
    <h2>Competitors</h2>
    <p>
      <label for="num-competitors">Number of competitors (4-16):</label>
      <input type="number" id="num-competitors" min="4" max="16" value="8">
      <button id="update-competitors">Update</button>
    </p>
    
    <div id="competitor-list" class="competitor-list">
      <!-- Competitors will be added here dynamically -->
    </div>
    
    <button id="generate-bracket">Generate Bracket</button>
  </div>
  
  <div class="bracket-container">
    <div id="bracket-diagram" class="mermaid">
      <!-- Mermaid diagram will be inserted here -->
    </div>
  </div>
  
  <!-- Load Mermaid from CDN -->
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
  
  <script>
    // Initialize mermaid
    mermaid.initialize({
      startOnLoad: true,
      theme: 'default',
      flowchart: {
        useMaxWidth: false
      }
    });
    
    // DOM elements
    const numCompetitorsInput = document.getElementById('num-competitors');
    const updateCompetitorsButton = document.getElementById('update-competitors');
    const competitorListDiv = document.getElementById('competitor-list');
    const generateBracketButton = document.getElementById('generate-bracket');
    const bracketDiagramDiv = document.getElementById('bracket-diagram');
    
    // Event listeners
    updateCompetitorsButton.addEventListener('click', updateCompetitorList);
    generateBracketButton.addEventListener('click', generateBracket);
    
    // Initial setup
    updateCompetitorList();
    
    // Function to update the competitor list based on the selected number
    function updateCompetitorList() {
      const numCompetitors = parseInt(numCompetitorsInput.value) || 8;
      
      // Clear the current list
      competitorListDiv.innerHTML = '';
      
      // Create new competitor inputs
      for (let i = 0; i < numCompetitors; i++) {
        const competitorDiv = document.createElement('div');
        competitorDiv.className = 'competitor';
        
        const seedInput = document.createElement('input');
        seedInput.type = 'number';
        seedInput.value = i + 1;
        seedInput.min = 1;
        seedInput.max = numCompetitors;
        seedInput.dataset.index = i;
        seedInput.className = 'seed-input';
        
        const nameInput = document.createElement('input');
        nameInput.type = 'text';
        nameInput.value = `Player ${i + 1}`;
        nameInput.dataset.index = i;
        nameInput.className = 'name-input';
        
        competitorDiv.appendChild(seedInput);
        competitorDiv.appendChild(nameInput);
        competitorListDiv.appendChild(competitorDiv);
      }
    }
    
    // Function to generate the tournament bracket
    function generateBracket() {
      // Collect competitor data
      const seeds = Array.from(document.querySelectorAll('.seed-input')).map(input => parseInt(input.value));
      const names = Array.from(document.querySelectorAll('.name-input')).map(input => input.value);
      
      // Create competitors array
      const competitors = seeds.map((seed, i) => ({
        seed: seed,
        name: names[i] || `Player ${i+1}`
      }));
      
      // Generate bracket using standard 32-slot seeding
      const seedOrder = [
        1, 32, 16, 17, 8, 25, 9, 24, 4, 29, 13, 20, 5, 28, 12, 21,
        2, 31, 15, 18, 7, 26, 10, 23, 3, 30, 14, 19, 6, 27, 11, 22
      ];
      
      // Map competitors to slots
      const competitorMap = {};
      competitors.forEach(comp => {
        competitorMap[comp.seed] = comp;
      });
      
      // Create mermaid flowchart syntax
      let diagram = `flowchart LR\n`;
      
      // Add styles
      diagram += `classDef competitor fill:#f9f9f9,stroke:#333,stroke-width:1px,rx:4px,ry:4px\n`;
      diagram += `classDef bye fill:#f0f0f0,stroke:#999,stroke-width:1px,rx:4px,ry:4px,font-style:italic\n`;
      
      // Create first round matches (16 matches)
      for (let i = 0; i < 16; i++) {
        const topSeedNum = seedOrder[i*2];
        const bottomSeedNum = seedOrder[i*2+1];
        
        const topSeed = topSeedNum <= competitors.length ? competitorMap[topSeedNum] : null;
        const bottomSeed = bottomSeedNum <= competitors.length ? competitorMap[bottomSeedNum] : null;
        
        const topLabel = topSeed ? `[${topSeed.seed}] ${topSeed.name}` : 'BYE';
        const bottomLabel = bottomSeed ? `[${bottomSeed.seed}] ${bottomSeed.name}` : 'BYE';
        
        // Match node
        diagram += `M${i+1}["${topLabel}<hr/>${bottomLabel}"]\n`;
        
        // Apply style
        const hasBye = !topSeed || !bottomSeed;
        if (hasBye) {
          diagram += `M${i+1}:::bye\n`;
        } else {
          diagram += `M${i+1}:::competitor\n`;
        }
      }
      
      // Create second round matches (8 matches)
      for (let i = 0; i < 8; i++) {
        diagram += `R2M${i+1}["Round 2<hr/>Match ${i+1}"]\n`;
        diagram += `M${i*2+1} --> R2M${i+1}\n`;
        diagram += `M${i*2+2} --> R2M${i+1}\n`;
      }
      
      // Create quarterfinals (4 matches)
      for (let i = 0; i < 4; i++) {
        diagram += `R3M${i+1}["Quarterfinal<hr/>Match ${i+1}"]\n`;
        diagram += `R2M${i*2+1} --> R3M${i+1}\n`;
        diagram += `R2M${i*2+2} --> R3M${i+1}\n`;
      }
      
      // Create semifinals (2 matches)
      for (let i = 0; i < 2; i++) {
        diagram += `R4M${i+1}["Semifinal<hr/>Match ${i+1}"]\n`;
        diagram += `R3M${i*2+1} --> R4M${i+1}\n`;
        diagram += `R3M${i*2+2} --> R4M${i+1}\n`;
      }
      
      // Create final
      diagram += `Final["Final<hr/>Match"]\n`;
      diagram += `R4M1 --> Final\n`;
      diagram += `R4M2 --> Final\n`;
      
      // Set the diagram
      bracketDiagramDiv.innerHTML = diagram;
      
      // Re-render mermaid diagram
      mermaid.init(undefined, document.querySelector('.mermaid'));
    }
    
    // Generate an initial bracket
    setTimeout(generateBracket, 500);
  </script>
</body>
</html>